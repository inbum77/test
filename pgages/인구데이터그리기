import streamlit as st
import pandas as pd
import matplotlib.pyplot as plt

# ë°ì´í„° ë¡œë“œ
@st.cache_data
def load_data():
    df = pd.read_csv("age2411.csv")
    return df

df = load_data()

# ì‚¬ìš©ì ì¸í„°í˜ì´ìŠ¤
st.title("ğŸ˜ï¸ ìš°ë¦¬ ë™ë„¤ ì¸êµ¬ êµ¬ì¡°ë¥¼ ì•Œì•„ë³´ì!")
st.write("ì›í•˜ëŠ” ì§€ì—­ì„ ì„ íƒí•˜ë©´ í•´ë‹¹ ì§€ì—­ì˜ ì¸êµ¬ êµ¬ì¡°ë¥¼ ì‹œê°í™”í•´ë“œë¦½ë‹ˆë‹¤.ğŸ“Š")

# ì§€ì—­ ì„ íƒ
regions = df['í–‰ì •êµ¬ì—­'].unique()
selected_region = st.selectbox("ğŸ” ì§€ì—­ì„ ì„ íƒí•˜ì„¸ìš”:", regions)

# ì„ íƒí•œ ì§€ì—­ í•„í„°ë§
selected_data = df[df['í–‰ì •êµ¬ì—­'] == selected_region]

# ì—°ë ¹ëŒ€ë³„ ì¸êµ¬ ì¶”ì¶œ
age_columns = [col for col in df.columns if 'ê³„_' in col and 'ì´ì¸êµ¬ìˆ˜' not in col and 'ì—°ë ¹êµ¬ê°„ì¸êµ¬ìˆ˜' not in col]
age_data = selected_data[age_columns].iloc[0].values

# ì—°ë ¹ëŒ€ ì´ë¦„ ì •ë¦¬
ages = [col.split('_')[2] for col in age_columns]

# ê·¸ë˜í”„ ê·¸ë¦¬ê¸°
fig, ax = plt.subplots(figsize=(10, 6))
ax.bar(ages, age_data)
plt.xticks(rotation=90)
plt.title(f"{selected_region}ì˜ ì—°ë ¹ëŒ€ë³„ ì¸êµ¬ êµ¬ì¡°")
plt.xlabel("ì—°ë ¹ëŒ€")
plt.ylabel("ì¸êµ¬ìˆ˜")
st.pyplot(fig)

st.write("ğŸ“Œ ì´ ê·¸ë˜í”„ë¥¼ í†µí•´ ì—°ë ¹ëŒ€ë³„ ì¸êµ¬ê°€ ì–´ë–»ê²Œ ë¶„í¬ë˜ì–´ ìˆëŠ”ì§€ í™•ì¸í•´ë³´ì„¸ìš”!")
